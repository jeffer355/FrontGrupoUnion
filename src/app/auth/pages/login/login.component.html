<div class="login-container">
    <div class="illustration-column">
        <img src="/assets/images/banerlogin.webp" alt="Ilustración" class="illustration-image">
    </div>

    <div class="form-column">
        <header class="form-header">
            <span class="logo-text">
                <img src="/assets/images/GRUPO UNION-Photoroom.png" class="header-logo-image"> Grupo Unión
            </span>
        </header>

        <main class="login-form-content">
            
            <div *ngIf="step === 'LOGIN'" class="fade-in">
                <h1 class="welcome-title">Bienvenido</h1>
                
                <div *ngIf="logoutMessage" style="color: #10b981; margin-bottom: 15px; text-align:center;">
                    {{ logoutMessage }}
                </div>

                <form [formGroup]="loginForm" (ngSubmit)="onSubmitLogin()" class="login-form">
                    <div class="form-group">
                        <label>Email</label>
                        <input type="email" formControlName="username" class="form-input" placeholder="Ingresa tu email">
                    </div>
                    
                    <div class="form-group">
                        <div class="password-header">
                            <label>Contraseña</label>
                        </div>
                        <div class="password-input-group" style="position: relative;">
                            <input [type]="passwordFieldType" formControlName="password" class="form-input" placeholder="******">
                            
                            <span class="password-toggle" (click)="togglePasswordVisibility()" 
                                  style="position: absolute; right: 10px; top: 10px; cursor: pointer;">
                                <svg *ngIf="passwordFieldType === 'password'" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg>
                                <svg *ngIf="passwordFieldType === 'text'" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.93 4.24m-1.76-3.86a3 3 0 1 1-4.72-4.14"/><line x1="1" y1="1" x2="23" y2="23"/></svg>
                            </span>
                        </div>
                    </div>

                    <button type="submit" class="login-button" [disabled]="isLoading">
                        {{ isLoading ? 'Verificando...' : 'Iniciar Sesión' }}
                    </button>
                </form>
            </div>

            <div *ngIf="step === 'CHANGE_PASS'" class="fade-in">
                <h1 class="welcome-title">Primer Ingreso</h1>
                <p style="color: #ccc; margin-bottom: 20px;">Por seguridad, debes cambiar tu contraseña.</p>
                <form [formGroup]="changePassForm" (ngSubmit)="onSubmitChangePass()" class="login-form">
                    <div class="form-group">
                        <label>Nueva Contraseña</label>
                        <input type="password" formControlName="newPassword" class="form-input">
                    </div>
                    <div class="form-group">
                        <label>Confirmar Contraseña</label>
                        <input type="password" formControlName="confirmPassword" class="form-input">
                    </div>
                    <button type="submit" class="login-button" [disabled]="isLoading">Actualizar</button>
                </form>
            </div>

            <div *ngIf="step === 'TOKEN'" class="fade-in">
                <h1 class="welcome-title">Verificación</h1>
                <p style="color: #ccc; margin-bottom: 20px;">Ingresa el código enviado a <strong>{{ tempUsername }}</strong></p>
                <form [formGroup]="tokenForm" (ngSubmit)="onSubmitToken()" class="login-form">
                    <div class="form-group">
                        <input type="text" formControlName="token" class="form-input" placeholder="123456" style="text-align: center; letter-spacing: 5px; font-size: 1.5rem;">
                    </div>
                    <button type="submit" class="login-button" [disabled]="isLoading">
                        {{ isLoading ? 'Validando...' : 'Ingresar' }}
                    </button>
                </form>
                <a href="javascript:void(0)" (click)="step='LOGIN'" style="display:block; text-align:center; margin-top:15px; color:#666;">Volver</a>
            </div>

        </main>
    </div>
</div>